---
import BaseLayout from '../layouts/BaseLayout.astro';
import PostCard from '../components/blog/PostCard.astro';
import { getCollection } from 'astro:content';

const posts = await getCollection('posts', ({ data }) => {
  return import.meta.env.PROD ? data.draft !== true : true;
});

// Sort by latest date
posts.sort((a, b) => b.data.date.valueOf() - a.data.date.valueOf());
---

<BaseLayout 
  title="Minions Blog" 
  description="News, updates, tutorials, and guides from the Minions open-source ecosystem"
>
  <div class="container mx-auto px-4 md:px-6 py-16 md:py-24 max-w-6xl text-center">
    <h1 class="text-4xl md:text-6xl font-extrabold text-primary tracking-tight mb-6">
      Minions <span class="text-accent relative after:content-[''] after:absolute after:bottom-1 after:left-0 after:w-full after:h-2 after:bg-accent/20 after:-z-10">Blog</span>
    </h1>
    <p class="text-lg md:text-xl text-muted max-w-2xl mx-auto mb-16">
      News, updates, tutorials, and guides from the Minions open-source ecosystem. Learned typed and validated agents correctly.
    </p>

    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 md:gap-8 text-left">
      {posts.map((post) => (
        <PostCard post={post} />
      ))}
    </div>

    {posts.length === 0 && (
      <div class="text-center py-20 mt-12 border border-dashed border-border rounded-xl">
        <h3 class="text-xl font-medium text-primary mb-2">No posts yet</h3>
        <p class="text-muted">Check back later for news and updates.</p>
      </div>
    )}
  </div>
</BaseLayout>
